{"ast":null,"code":"import _objectSpread from\"C:/Users/merci/Local Sites/wordpress-react-test/app/public/wp-content/plugins/booking67/components/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/merci/Local Sites/wordpress-react-test/app/public/wp-content/plugins/booking67/components/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import fetchOptions from\"./scripts/fetchOptions\";import Booking67_Appointment from\"./Booking67_Appointment\";import{useFetch}from\"../hooks/useFetch\";import'./css/appointmentsDisplayer.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AppointmentsDisplayer(){var _useState=useState({hasFixedTimeSlots:false,slotDuration:0,multipleAppointments:false,maxAppointments:0,multiplePracticians:false,multiPrestations:false,indicateNumberOfParticipants:false,allowObservations:false}),_useState2=_slicedToArray(_useState,2),options=_useState2[0],setOptions=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),appointments=_useState6[0],setAppointments=_useState6[1];var _useState7=useState({show:false,url:'',appointmentId:null,type:null}),_useState8=_slicedToArray(_useState7,2),modalInfo=_useState8[0],setModalInfo=_useState8[1];//recuperation des options necessaires\nuseEffect(function(){setIsLoading(true);fetchOptions(['genType_multipleAppointments','genType_slotDuration','genType_maxAppointments','genType_multiplePracticians','genType_multiPrestations','genType_indicateNumberOfParticipants','genType_allowObservations']).then(function(data){setOptions(transformFetchedOptions(data));}).finally(function(){//recuperation des rdv futur\nbooking67_getUpcommingAppointments();setIsLoading(false);// Désactiver le loader après avoir récupéré les données\n});},[]);var transformFetchedOptions=function transformFetchedOptions(fetchedOptions){var newOptions=_objectSpread({},options);fetchedOptions.forEach(function(opt){var key=opt.generic_type.replace('genType_','');newOptions[key]=opt.value==='true'||opt.value==='false'?opt.value==='true':opt.value;});return newOptions;};var handleModalOpen=function handleModalOpen(url,appointmentId,type){setModalInfo({show:true,url:url,appointmentId:appointmentId,type:type});};var handleModalClose=function handleModalClose(){setModalInfo({show:false,url:'',appointmentId:null});};var booking67_getUpcommingAppointments=function booking67_getUpcommingAppointments(){fetch('/wp-json/booking67/v1/upcoming-appointments',{method:'GET',headers:{'Content-Type':'application/json'}}).then(function(response){if(!response.ok){throw new Error('Erreur réseau');}return response.json();}).then(function(data){setAppointments(data);// Traiter les données ici\nconsole.log('data',data);}).catch(function(error){return console.error('Erreur:',error);});};return/*#__PURE__*/_jsx(\"div\",{children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"loader\"}):/*#__PURE__*/_jsxs(\"div\",{children:[appointments.map(function(rdv){return/*#__PURE__*/_jsx(Booking67_Appointment,{rdv:rdv,options:options,onModalOpen:handleModalOpen,isHighlighted:modalInfo.appointmentId===rdv.id},rdv.id);}),modalInfo.show&&/*#__PURE__*/_jsx(Modal,{url:modalInfo.url,onClose:handleModalClose})]})});}function Modal(_ref){var onClose=_ref.onClose,url=_ref.url,type=_ref.type;var _useFetch=useFetch(url,[]),loading=_useFetch.loading,data=_useFetch.data,errors=_useFetch.errors;console.log('data',data);var content;if(loading){content=/*#__PURE__*/_jsx(\"div\",{children:\"Chargement...\"});}else if(errors){content=/*#__PURE__*/_jsxs(\"div\",{children:[\"Erreur: \",errors]});}else{if(type==='practician'){content=/*#__PURE__*/_jsx(\"div\",{});}else if(type==='prestation'){content=/*#__PURE__*/_jsx(\"div\",{});}}return/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[content,/*#__PURE__*/_jsx(\"button\",{onClick:onClose,children:\"Fermer\"})]})});}export default AppointmentsDisplayer;","map":{"version":3,"names":["React","useState","useEffect","fetchOptions","Booking67_Appointment","useFetch","jsx","_jsx","jsxs","_jsxs","AppointmentsDisplayer","_useState","hasFixedTimeSlots","slotDuration","multipleAppointments","maxAppointments","multiplePracticians","multiPrestations","indicateNumberOfParticipants","allowObservations","_useState2","_slicedToArray","options","setOptions","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","appointments","setAppointments","_useState7","show","url","appointmentId","type","_useState8","modalInfo","setModalInfo","then","data","transformFetchedOptions","finally","booking67_getUpcommingAppointments","fetchedOptions","newOptions","_objectSpread","forEach","opt","key","generic_type","replace","value","handleModalOpen","handleModalClose","fetch","method","headers","response","ok","Error","json","console","log","catch","error","children","className","map","rdv","onModalOpen","isHighlighted","id","Modal","onClose","_ref","_useFetch","loading","errors","content","onClick"],"sources":["C:/Users/merci/Local Sites/wordpress-react-test/app/public/wp-content/plugins/booking67/components/src/components/AppointmentsDisplayer.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport fetchOptions from \"./scripts/fetchOptions\";\r\nimport Booking67_Appointment from \"./Booking67_Appointment\";\r\nimport {useFetch} from \"../hooks/useFetch\";\r\nimport  './css/appointmentsDisplayer.css'\r\nfunction AppointmentsDisplayer() {\r\n    const [options, setOptions] = useState({\r\n        hasFixedTimeSlots: false,\r\n        slotDuration: 0,\r\n        multipleAppointments: false,\r\n        maxAppointments: 0,\r\n        multiplePracticians: false,\r\n        multiPrestations: false,\r\n        indicateNumberOfParticipants: false,\r\n        allowObservations: false\r\n    });\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [appointments, setAppointments] = useState([]);\r\n    const [modalInfo, setModalInfo] = useState({ show: false, url: '', appointmentId: null, type: null });\r\n    //recuperation des options necessaires\r\n    useEffect(() => {\r\n        setIsLoading(true);\r\n        fetchOptions([ 'genType_multipleAppointments', 'genType_slotDuration', 'genType_maxAppointments', 'genType_multiplePracticians', 'genType_multiPrestations', 'genType_indicateNumberOfParticipants', 'genType_allowObservations'])\r\n        .then(data => {\r\n                setOptions(transformFetchedOptions(data));\r\n            })\r\n                .finally(() => {\r\n                    //recuperation des rdv futur\r\n                    booking67_getUpcommingAppointments();\r\n                    setIsLoading(false); // Désactiver le loader après avoir récupéré les données\r\n                });\r\n        }, []);\r\n    const transformFetchedOptions = (fetchedOptions) => {\r\n        let newOptions = { ...options };\r\n        fetchedOptions.forEach(opt => {\r\n            const key = opt.generic_type.replace('genType_', '');\r\n            newOptions[key] = (opt.value === 'true' || opt.value === 'false') ? opt.value === 'true' : opt.value;\r\n        });\r\n        return newOptions;\r\n    };\r\n\r\n    const handleModalOpen = (url, appointmentId, type) => {\r\n        setModalInfo({ show: true, url, appointmentId, type });\r\n    };\r\n    const handleModalClose = () => {\r\n        setModalInfo({ show: false, url: '', appointmentId: null });\r\n    };\r\nconst booking67_getUpcommingAppointments = ()=>{\r\n        fetch('/wp-json/booking67/v1/upcoming-appointments', {\r\n            method: 'GET',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            }\r\n        })\r\n            .then(response => {\r\n                if (!response.ok) {\r\n                    throw new Error('Erreur réseau');\r\n                }\r\n                return response.json();\r\n            })\r\n            .then(data => {\r\n                setAppointments(data);\r\n                // Traiter les données ici\r\n                console.log('data',data);\r\n            })\r\n            .catch((error) => console.error('Erreur:', error));\r\n    }\r\n    return (\r\n        <div>\r\n            {isLoading ? (\r\n                <div className='loader'></div>\r\n            ) : (\r\n                <div>\r\n                    {appointments.map(rdv => (\r\n                        <Booking67_Appointment\r\n                            key={rdv.id}\r\n                            rdv={rdv}\r\n                            options={options}\r\n                            onModalOpen={handleModalOpen}\r\n                            isHighlighted={modalInfo.appointmentId === rdv.id}\r\n                        />\r\n                    ))}\r\n                    {modalInfo.show && (\r\n                        <Modal\r\n                            url={modalInfo.url}\r\n                            onClose={handleModalClose}\r\n\r\n                        />\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\nfunction Modal({ onClose, url, type }) {\r\n    const { loading, data, errors } = useFetch(url, []);\r\nconsole.log('data',data)\r\n    let content;\r\n    if (loading) {\r\n        content = <div>Chargement...</div>;\r\n    } else if (errors) {\r\n        content = <div>Erreur: {errors}</div>;\r\n    } else {\r\n        if (type === 'practician') {\r\n            content = <div>{/* Contenu pour le praticien */}</div>;\r\n        } else if (type === 'prestation') {\r\n            content = <div>{/* Contenu pour la prestation */}</div>;\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"modal-backdrop\">\r\n            <div className=\"modal-content\">\r\n                {content}\r\n                <button onClick={onClose}>Fermer</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nexport  default AppointmentsDisplayer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}