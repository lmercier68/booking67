{"ast":null,"code":"import _objectSpread from\"C:/Users/merci/Local Sites/wordpress-react-test/app/public/wp-content/plugins/booking67/components/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/merci/Local Sites/wordpress-react-test/app/public/wp-content/plugins/booking67/components/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import fetchOptions from\"./scripts/fetchOptions\";import Booking67_Appointment from\"./Booking67_Appointment\";import{useFetch}from\"../hooks/useFetch\";import'./css/appointmentsDisplayer.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AppointmentsDisplayer(){var _useState=useState({hasFixedTimeSlots:false,slotDuration:0,multipleAppointments:false,maxAppointments:0,multiplePracticians:false,multiPrestations:false,indicateNumberOfParticipants:false,allowObservations:false}),_useState2=_slicedToArray(_useState,2),options=_useState2[0],setOptions=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),appointments=_useState6[0],setAppointments=_useState6[1];//recuperation des options necessaires\nuseEffect(function(){setIsLoading(true);fetchOptions(['genType_multipleAppointments','genType_slotDuration','genType_maxAppointments','genType_multiplePracticians','genType_multiPrestations','genType_indicateNumberOfParticipants','genType_allowObservations']).then(function(data){setOptions(transformFetchedOptions(data));}).finally(function(){//recuperation des rdv futur\nbooking67_getUpcommingAppointments();setIsLoading(false);// Désactiver le loader après avoir récupéré les données\n});},[]);var transformFetchedOptions=function transformFetchedOptions(fetchedOptions){var newOptions=_objectSpread({},options);fetchedOptions.forEach(function(opt){var key=opt.generic_type.replace('genType_','');newOptions[key]=opt.value==='true'||opt.value==='false'?opt.value==='true':opt.value;});return newOptions;};var _useState7=useState({show:false,url:'',appointmentId:null}),_useState8=_slicedToArray(_useState7,2),modalInfo=_useState8[0],setModalInfo=_useState8[1];var handleModalOpen=function handleModalOpen(url,appointmentId){setModalInfo({show:true,url:url,appointmentId:appointmentId});};var handleModalClose=function handleModalClose(){setModalInfo({show:false,url:'',appointmentId:null});};var booking67_getUpcommingAppointments=function booking67_getUpcommingAppointments(){fetch('/wp-json/booking67/v1/upcoming-appointments',{method:'GET',headers:{'Content-Type':'application/json'}}).then(function(response){if(!response.ok){throw new Error('Erreur réseau');}return response.json();}).then(function(data){setAppointments(data);// Traiter les données ici\nconsole.log('data',data);}).catch(function(error){return console.error('Erreur:',error);});};return/*#__PURE__*/_jsx(\"div\",{children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"loader\"}):/*#__PURE__*/_jsxs(\"div\",{children:[appointments.map(function(rdv){return/*#__PURE__*/_jsx(Booking67_Appointment,{rdv:rdv,options:options,onModalOpen:handleModalOpen,isHighlighted:modalInfo.appointmentId===rdv.id},rdv.id);}),modalInfo.show&&/*#__PURE__*/_jsx(Modal,{url:modalInfo.url,onClose:handleModalClose})]})});}function Modal(_ref){var onClose=_ref.onClose,url=_ref.url;var _useFetch=useFetch(url,[]),loading=_useFetch.loading,data=_useFetch.data,errors=_useFetch.errors;var content;if(loading){content=/*#__PURE__*/_jsx(\"div\",{className:\"loader\",children:\"Chargement...\"});}else if(errors){content=/*#__PURE__*/_jsxs(\"div\",{children:[\"Erreur: \",errors]});}else{content=/*#__PURE__*/_jsx(\"div\",{children:JSON.stringify(data)});}return/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[content.prestation_name?'toto':content.role?'tata':'tonton',content,/*#__PURE__*/_jsx(\"button\",{onClick:onClose,children:\"Fermer\"})]})});}export default AppointmentsDisplayer;","map":{"version":3,"names":["React","useState","useEffect","fetchOptions","Booking67_Appointment","useFetch","jsx","_jsx","jsxs","_jsxs","AppointmentsDisplayer","_useState","hasFixedTimeSlots","slotDuration","multipleAppointments","maxAppointments","multiplePracticians","multiPrestations","indicateNumberOfParticipants","allowObservations","_useState2","_slicedToArray","options","setOptions","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","appointments","setAppointments","then","data","transformFetchedOptions","finally","booking67_getUpcommingAppointments","fetchedOptions","newOptions","_objectSpread","forEach","opt","key","generic_type","replace","value","_useState7","show","url","appointmentId","_useState8","modalInfo","setModalInfo","handleModalOpen","handleModalClose","fetch","method","headers","response","ok","Error","json","console","log","catch","error","children","className","map","rdv","onModalOpen","isHighlighted","id","Modal","onClose","_ref","_useFetch","loading","errors","content","JSON","stringify","prestation_name","role","onClick"],"sources":["C:/Users/merci/Local Sites/wordpress-react-test/app/public/wp-content/plugins/booking67/components/src/components/AppointmentsDisplayer.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport fetchOptions from \"./scripts/fetchOptions\";\r\nimport Booking67_Appointment from \"./Booking67_Appointment\";\r\nimport {useFetch} from \"../hooks/useFetch\";\r\nimport  './css/appointmentsDisplayer.css'\r\nfunction AppointmentsDisplayer() {\r\n    const [options, setOptions] = useState({\r\n        hasFixedTimeSlots: false,\r\n        slotDuration: 0,\r\n        multipleAppointments: false,\r\n        maxAppointments: 0,\r\n        multiplePracticians: false,\r\n        multiPrestations: false,\r\n        indicateNumberOfParticipants: false,\r\n        allowObservations: false\r\n    });\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [appointments, setAppointments] = useState([]);\r\n\r\n    //recuperation des options necessaires\r\n    useEffect(() => {\r\n        setIsLoading(true);\r\n        fetchOptions([ 'genType_multipleAppointments', 'genType_slotDuration', 'genType_maxAppointments', 'genType_multiplePracticians', 'genType_multiPrestations', 'genType_indicateNumberOfParticipants', 'genType_allowObservations'])\r\n        .then(data => {\r\n                setOptions(transformFetchedOptions(data));\r\n            })\r\n                .finally(() => {\r\n                    //recuperation des rdv futur\r\n                    booking67_getUpcommingAppointments();\r\n                    setIsLoading(false); // Désactiver le loader après avoir récupéré les données\r\n                });\r\n        }, []);\r\n    const transformFetchedOptions = (fetchedOptions) => {\r\n        let newOptions = { ...options };\r\n        fetchedOptions.forEach(opt => {\r\n            const key = opt.generic_type.replace('genType_', '');\r\n            newOptions[key] = (opt.value === 'true' || opt.value === 'false') ? opt.value === 'true' : opt.value;\r\n        });\r\n        return newOptions;\r\n    };\r\n    const [modalInfo, setModalInfo] = useState({ show: false, url: '', appointmentId: null });\r\n\r\n    const handleModalOpen = (url, appointmentId) => {\r\n        setModalInfo({ show: true, url, appointmentId });\r\n    };\r\n\r\n    const handleModalClose = () => {\r\n        setModalInfo({ show: false, url: '', appointmentId: null });\r\n    };\r\nconst booking67_getUpcommingAppointments = ()=>{\r\n        fetch('/wp-json/booking67/v1/upcoming-appointments', {\r\n            method: 'GET',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            }\r\n        })\r\n            .then(response => {\r\n                if (!response.ok) {\r\n                    throw new Error('Erreur réseau');\r\n                }\r\n                return response.json();\r\n            })\r\n            .then(data => {\r\n                setAppointments(data);\r\n                // Traiter les données ici\r\n                console.log('data',data);\r\n            })\r\n            .catch((error) => console.error('Erreur:', error));\r\n    }\r\n    return (\r\n        <div>\r\n            {isLoading ? (\r\n                <div className='loader'></div>\r\n            ) : (\r\n                <div>\r\n                    {appointments.map(rdv => (\r\n                        <Booking67_Appointment\r\n                            key={rdv.id}\r\n                            rdv={rdv}\r\n                            options={options}\r\n                            onModalOpen={handleModalOpen}\r\n                            isHighlighted={modalInfo.appointmentId === rdv.id}\r\n                        />\r\n                    ))}\r\n                    {modalInfo.show && (\r\n                        <Modal\r\n                            url={modalInfo.url}\r\n                            onClose={handleModalClose}\r\n\r\n                        />\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\nfunction Modal({ onClose, url}) {\r\n    const { loading, data, errors } = useFetch(url, []);\r\n\r\n    let content;\r\n    if (loading) {\r\n        content = <div className='loader'>Chargement...</div>;\r\n    } else if (errors) {\r\n        content = <div>Erreur: {errors}</div>;\r\n    } else {\r\n        content = <div>{JSON.stringify(data)}</div>\r\n    }\r\n\r\n    return (\r\n        <div className=\"modal-backdrop\">\r\n            <div className=\"modal-content\">\r\n                {content.prestation_name?'toto':(content.role?'tata':'tonton')}\r\n                {content}\r\n                <button onClick={onClose}>Fermer</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nexport  default AppointmentsDisplayer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}