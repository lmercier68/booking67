!function(){"use strict";var e={n:function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},d:function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.React,n=window.ReactDOM,o=e.n(n),a=window.wp.element,r=function({practitionerId:e,onPrestationChange:n}){const[o,r]=(0,a.useState)([]);return(0,a.useEffect)((()=>{(async()=>{if(0!==e&&void 0!==e){let t="/wp-json/booker67/v1/prestations";e&&(t+=`/practitioner_id/${e}`),console.log('recuperation des prestation pour l"id: ',e);try{const e=await fetch(t),n=await e.json();console.log("prestation recupérée : ",n),r(n)}catch(e){console.error("Erreur lors de la récupération des prestations:",e)}}})()}),[e]),console.log("prestations for practician: ",o),(0,t.createElement)("select",{onChange:e=>{n(e.target.value)}},(0,t.createElement)("option",{value:""},"Sélectionnez une prestation"),o.map((e=>(0,t.createElement)("option",{key:e.id,value:e.id},e.prestation_name," - ",e.prestation_cost," - ",e.prestation_duration))))},s=function({onPractitionerChange:e}){const[n,o]=(0,t.useState)([]);return(0,t.useEffect)((()=>{fetch("/wp-json/booker67/v1/human_ressources_actif").then((e=>e.json())).then((e=>{o(e)})).catch((e=>{console.error(e)}))}),[]),(0,t.createElement)("div",null,(0,t.createElement)("select",{id:"humanRessourceSelect",onChange:t=>{e(t.target.value)}},n.map((e=>(0,t.createElement)("option",{key:e.id,value:e.id},e.nom," ",e.prenom," - ",e.role)))))},i=({dateTimeSlot:e,practician:n,prestation:o,setNewAppointment:a,onClose:r})=>{console.log(e);const s={backgroundColor:"#f44336",color:"white",padding:"10px 20px",margin:"10px",border:"none",borderRadius:"5px",cursor:"pointer",boxShadow:"0 2px 2px rgba(0, 0, 0, 0.2)"};return(0,t.createElement)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",borderRadius:"10px",border:"2px",zIndex:1e3}},n?o?(0,t.createElement)("div",null,(0,t.createElement)("h3",null,"Veuillez confirmer votre prise de rendez-vous"),(0,t.createElement)("p",null,(0,t.createElement)("br",null),(0,t.createElement)("b",null,"Praticien :")," ",n.nom," ",n.prenom," - ",(0,t.createElement)("b",null,n.role),(0,t.createElement)("hr",null),(0,t.createElement)("b",null,"Prestation :")," ",(0,t.createElement)("b",null,o.prestation_name)," au tarif de ",(0,t.createElement)("b",null,o.prestation_cost)," pour une durée de ",(0,t.createElement)("b",null,o.prestation_duration),(0,t.createElement)("hr",null),(0,t.createElement)("b",null,"date du rendez-vous :"),"  le ",e.day," ",e.date," à ",(0,t.createElement)("b",null,e.time)),(0,t.createElement)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"20px"}},(0,t.createElement)("button",{style:{backgroundColor:"#4CAF50",color:"white",padding:"10px 20px",margin:"10px",border:"none",borderRadius:"5px",cursor:"pointer",boxShadow:"0 2px 2px rgba(0, 0, 0, 0.2)"},onClick:()=>{a(!0),r()}},"Valider"),(0,t.createElement)("button",{style:s,onClick:()=>{a(!1),r()}},"Annuler"))):(0,t.createElement)("div",null,"merci de choisir une prestation",(0,t.createElement)("button",{style:s,onClick:()=>{a(!1),r()}},"Annuler")):(0,t.createElement)("div",null,"merci de choisir un praticien",(0,t.createElement)("button",{style:s,onClick:()=>{a(!1),r()}},"Annuler")))},l=function({practician:e,prestation:n,selectedWeek:o,slot:a,setNewAppointment:r,dateTimeSlot:s,setDateTimeSlot:l}){const[c,u]=(0,t.useState)(!1),[d,p]=(0,t.useState)(!1);if(!a)return null;const{time:m,isAvailable:f}=a,g=new Date("1970-01-01T"+m).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit",hour12:!1}),h=(e,t)=>{const n=new Date,o=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(e),[r,s]=t.split(":");return a.setHours(r,s,0,0),a<o||a.toDateString()===o.toDateString()&&a<n},y={padding:"5px",backgroundColor:f?c?"orange":"white":"#f44336",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",borderRadius:"10px",border:"2px solid #ccc",cursor:!f||a.date&&h(a.date,m)?"not-allowed":"pointer",opacity:a.date&&h(a.date,m)?.5:1};return(0,t.createElement)("div",{onClick:()=>{f&&!d&&a.date&&!h(a.date,m)&&(l(a),p(!0),u(!0),console.log(`Plage horaire de ${m} pour une durée de X minutes cliquée.`))},onBlur:()=>{u(!1)},tabIndex:0,style:y},g,d&&(0,t.createElement)(i,{onClose:e=>{p(!1)},slot:a,setNewAppointment:r,practician:e,prestation:n,selectedWeek:o,dateTimeSlot:s}))},c=({practician:e,prestation:n,selectedWeek:o,slotsByDay:a,daysOfWeek:r,setNewAppointment:s,dateTimeSlot:i,setDateTimeSlot:c,timeOfDay:u})=>{const d=(e=>{const t=new Set;return Object.values(e).forEach((e=>{e.forEach((e=>{t.add(e.time)}))})),Array.from(t).sort()})(a),p=d.filter((e=>{const t=parseInt(e.split(":")[0]);return"AM"===u?t<12:t>=12})),m={width:100/r.length+"%",textAlign:"center",fontWeight:"bold"};return console.log("filteredTimes: ",p),(0,t.createElement)("table",{style:{width:"100%",tableLayout:"fixed"}},(0,t.createElement)("thead",{style:{textAlign:"center",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",borderRadius:"10px",border:"2px"}},(0,t.createElement)("tr",null,r.map((e=>(0,t.createElement)("th",{key:e},e))))),(0,t.createElement)("tbody",null,p.map(((u,d)=>(0,t.createElement)("tr",{key:d},r.map(((r,d)=>{const p=a[r]?.find((e=>e.time===u))||{time:u,isAvailable:!1},f=new Date(o.startDate);f.setDate(f.getDate()+d);const g={...p,date:f.toISOString().split("T")[0]};return(0,t.createElement)("td",{key:r,style:m},"toto",(0,t.createElement)(l,{slot:g,setNewAppointment:s,practician:e,prestation:n,selectedWeek:o,dateTimeSlot:i,setDateTimeSlot:c}))})))))))},u=function({onSelectionChange:e}){const[n,o]=(0,t.useState)("AM"),a=t=>{o(t.target.value),console.log(t.target.value),e(t.target.value)};return(0,t.createElement)("div",null,(0,t.createElement)("label",null,(0,t.createElement)("input",{type:"radio",value:"AM",checked:"AM"===n,onChange:a}),"Matin"),(0,t.createElement)("label",null,(0,t.createElement)("input",{type:"radio",value:"PM",checked:"PM"===n,onChange:a}),"Après-midi"))};function d(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=d(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}var p=function(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=d(e))&&(o&&(o+=" "),o+=t);return o};const m=e=>"number"==typeof e&&!isNaN(e),f=e=>"string"==typeof e,g=e=>"function"==typeof e,h=e=>f(e)||g(e)?e:null,y=e=>(0,t.isValidElement)(e)||f(e)||g(e)||m(e);function E(e){let{enter:n,exit:o,appendPosition:a=!1,collapse:r=!0,collapseDuration:s=300}=e;return function(e){let{children:i,position:l,preventExitTransition:c,done:u,nodeRef:d,isIn:p}=e;const m=a?`${n}--${l}`:n,f=a?`${o}--${l}`:o,g=(0,t.useRef)(0);return(0,t.useLayoutEffect)((()=>{const e=d.current,t=m.split(" "),n=o=>{o.target===d.current&&(e.dispatchEvent(new Event("d")),e.removeEventListener("animationend",n),e.removeEventListener("animationcancel",n),0===g.current&&"animationcancel"!==o.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",n),e.addEventListener("animationcancel",n)}),[]),(0,t.useEffect)((()=>{const e=d.current,t=()=>{e.removeEventListener("animationend",t),r?function(e,t,n){void 0===n&&(n=300);const{scrollHeight:o,style:a}=e;requestAnimationFrame((()=>{a.minHeight="initial",a.height=o+"px",a.transition=`all ${n}ms`,requestAnimationFrame((()=>{a.height="0",a.padding="0",a.margin="0",setTimeout(t,n)}))}))}(e,u,s):u()};p||(c?t():(g.current=1,e.className+=` ${f}`,e.addEventListener("animationend",t)))}),[p]),t.createElement(t.Fragment,null,i)}}function v(e,t){return null!=e?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}const T={list:new Map,emitQueue:new Map,on(e,t){return this.list.has(e)||this.list.set(e,[]),this.list.get(e).push(t),this},off(e,t){if(t){const n=this.list.get(e).filter((e=>e!==t));return this.list.set(e,n),this}return this.list.delete(e),this},cancelEmit(e){const t=this.emitQueue.get(e);return t&&(t.forEach(clearTimeout),this.emitQueue.delete(e)),this},emit(e){this.list.has(e)&&this.list.get(e).forEach((t=>{const n=setTimeout((()=>{t(...[].slice.call(arguments,1))}),0);this.emitQueue.has(e)||this.emitQueue.set(e,[]),this.emitQueue.get(e).push(n)}))}},b=e=>{let{theme:n,type:o,...a}=e;return t.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===n?"currentColor":`var(--toastify-icon-color-${o})`,...a})},w={info:function(e){return t.createElement(b,{...e},t.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return t.createElement(b,{...e},t.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return t.createElement(b,{...e},t.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return t.createElement(b,{...e},t.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return t.createElement("div",{className:"Toastify__spinner"})}};function D(e){const[,n]=(0,t.useReducer)((e=>e+1),0),[o,a]=(0,t.useState)([]),r=(0,t.useRef)(null),s=(0,t.useRef)(new Map).current,i=e=>-1!==o.indexOf(e),l=(0,t.useRef)({toastKey:1,displayedToast:0,count:0,queue:[],props:e,containerId:null,isToastActive:i,getToast:e=>s.get(e)}).current;function c(e){let{containerId:t}=e;const{limit:n}=l.props;!n||t&&l.containerId!==t||(l.count-=l.queue.length,l.queue=[])}function u(e){a((t=>null==e?[]:t.filter((t=>t!==e))))}function d(){const{toastContent:e,toastProps:t,staleId:n}=l.queue.shift();E(e,t,n)}function p(e,o){let{delay:a,staleId:i,...c}=o;if(!y(e)||function(e){return!r.current||l.props.enableMultiContainer&&e.containerId!==l.props.containerId||s.has(e.toastId)&&null==e.updateId}(c))return;const{toastId:p,updateId:b,data:D}=c,{props:_}=l,C=()=>u(p),S=null==b;S&&l.count++;const I={..._,style:_.toastStyle,key:l.toastKey++,...Object.fromEntries(Object.entries(c).filter((e=>{let[t,n]=e;return null!=n}))),toastId:p,updateId:b,data:D,closeToast:C,isIn:!1,className:h(c.className||_.toastClassName),bodyClassName:h(c.bodyClassName||_.bodyClassName),progressClassName:h(c.progressClassName||_.progressClassName),autoClose:!c.isLoading&&(x=c.autoClose,k=_.autoClose,!1===x||m(x)&&x>0?x:k),deleteToast(){const e=v(s.get(p),"removed");s.delete(p),T.emit(4,e);const t=l.queue.length;if(l.count=null==p?l.count-l.displayedToast:l.count-1,l.count<0&&(l.count=0),t>0){const e=null==p?l.props.limit:1;if(1===t||1===e)l.displayedToast++,d();else{const n=e>t?t:e;l.displayedToast=n;for(let e=0;e<n;e++)d()}}else n()}};var x,k;I.iconOut=function(e){let{theme:n,type:o,isLoading:a,icon:r}=e,s=null;const i={theme:n,type:o};return!1===r||(g(r)?s=r(i):(0,t.isValidElement)(r)?s=(0,t.cloneElement)(r,i):f(r)||m(r)?s=r:a?s=w.spinner():(e=>e in w)(o)&&(s=w[o](i))),s}(I),g(c.onOpen)&&(I.onOpen=c.onOpen),g(c.onClose)&&(I.onClose=c.onClose),I.closeButton=_.closeButton,!1===c.closeButton||y(c.closeButton)?I.closeButton=c.closeButton:!0===c.closeButton&&(I.closeButton=!y(_.closeButton)||_.closeButton);let O=e;(0,t.isValidElement)(e)&&!f(e.type)?O=(0,t.cloneElement)(e,{closeToast:C,toastProps:I,data:D}):g(e)&&(O=e({closeToast:C,toastProps:I,data:D})),_.limit&&_.limit>0&&l.count>_.limit&&S?l.queue.push({toastContent:O,toastProps:I,staleId:i}):m(a)?setTimeout((()=>{E(O,I,i)}),a):E(O,I,i)}function E(e,t,n){const{toastId:o}=t;n&&s.delete(n);const r={content:e,props:t};s.set(o,r),a((e=>[...e,o].filter((e=>e!==n)))),T.emit(4,v(r,null==r.props.updateId?"added":"updated"))}return(0,t.useEffect)((()=>(l.containerId=e.containerId,T.cancelEmit(3).on(0,p).on(1,(e=>r.current&&u(e))).on(5,c).emit(2,l),()=>{s.clear(),T.emit(3,l)})),[]),(0,t.useEffect)((()=>{l.props=e,l.isToastActive=i,l.displayedToast=o.length})),{getToastToRender:function(t){const n=new Map,o=Array.from(s.values());return e.newestOnTop&&o.reverse(),o.forEach((e=>{const{position:t}=e.props;n.has(t)||n.set(t,[]),n.get(t).push(e)})),Array.from(n,(e=>t(e[0],e[1])))},containerRef:r,isToastActive:i}}function _(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientX:e.clientX}function C(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function S(e){const[n,o]=(0,t.useState)(!1),[a,r]=(0,t.useState)(!1),s=(0,t.useRef)(null),i=(0,t.useRef)({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,l=(0,t.useRef)(e),{autoClose:c,pauseOnHover:u,closeToast:d,onClick:p,closeOnClick:m}=e;function f(t){if(e.draggable){"touchstart"===t.nativeEvent.type&&t.nativeEvent.preventDefault(),i.didMove=!1,document.addEventListener("mousemove",v),document.addEventListener("mouseup",T),document.addEventListener("touchmove",v),document.addEventListener("touchend",T);const n=s.current;i.canCloseOnClick=!0,i.canDrag=!0,i.boundingRect=n.getBoundingClientRect(),n.style.transition="",i.x=_(t.nativeEvent),i.y=C(t.nativeEvent),"x"===e.draggableDirection?(i.start=i.x,i.removalDistance=n.offsetWidth*(e.draggablePercent/100)):(i.start=i.y,i.removalDistance=n.offsetHeight*(80===e.draggablePercent?1.5*e.draggablePercent:e.draggablePercent/100))}}function h(t){if(i.boundingRect){const{top:n,bottom:o,left:a,right:r}=i.boundingRect;"touchend"!==t.nativeEvent.type&&e.pauseOnHover&&i.x>=a&&i.x<=r&&i.y>=n&&i.y<=o?E():y()}}function y(){o(!0)}function E(){o(!1)}function v(t){const o=s.current;i.canDrag&&o&&(i.didMove=!0,n&&E(),i.x=_(t),i.y=C(t),i.delta="x"===e.draggableDirection?i.x-i.start:i.y-i.start,i.start!==i.x&&(i.canCloseOnClick=!1),o.style.transform=`translate${e.draggableDirection}(${i.delta}px)`,o.style.opacity=""+(1-Math.abs(i.delta/i.removalDistance)))}function T(){document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",T),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",T);const t=s.current;if(i.canDrag&&i.didMove&&t){if(i.canDrag=!1,Math.abs(i.delta)>i.removalDistance)return r(!0),void e.closeToast();t.style.transition="transform 0.2s, opacity 0.2s",t.style.transform=`translate${e.draggableDirection}(0)`,t.style.opacity="1"}}(0,t.useEffect)((()=>{l.current=e})),(0,t.useEffect)((()=>(s.current&&s.current.addEventListener("d",y,{once:!0}),g(e.onOpen)&&e.onOpen((0,t.isValidElement)(e.children)&&e.children.props),()=>{const e=l.current;g(e.onClose)&&e.onClose((0,t.isValidElement)(e.children)&&e.children.props)})),[]),(0,t.useEffect)((()=>(e.pauseOnFocusLoss&&(document.hasFocus()||E(),window.addEventListener("focus",y),window.addEventListener("blur",E)),()=>{e.pauseOnFocusLoss&&(window.removeEventListener("focus",y),window.removeEventListener("blur",E))})),[e.pauseOnFocusLoss]);const b={onMouseDown:f,onTouchStart:f,onMouseUp:h,onTouchEnd:h};return c&&u&&(b.onMouseEnter=E,b.onMouseLeave=y),m&&(b.onClick=e=>{p&&p(e),i.canCloseOnClick&&d()}),{playToast:y,pauseToast:E,isRunning:n,preventExitTransition:a,toastRef:s,eventHandlers:b}}function I(e){let{closeToast:n,theme:o,ariaLabel:a="close"}=e;return t.createElement("button",{className:`Toastify__close-button Toastify__close-button--${o}`,type:"button",onClick:e=>{e.stopPropagation(),n(e)},"aria-label":a},t.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},t.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function x(e){let{delay:n,isRunning:o,closeToast:a,type:r="default",hide:s,className:i,style:l,controlledProgress:c,progress:u,rtl:d,isIn:m,theme:f}=e;const h=s||c&&0===u,y={...l,animationDuration:`${n}ms`,animationPlayState:o?"running":"paused",opacity:h?0:1};c&&(y.transform=`scaleX(${u})`);const E=p("Toastify__progress-bar",c?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${f}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":d}),v=g(i)?i({rtl:d,type:r,defaultClassName:E}):p(E,i);return t.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:v,style:y,[c&&u>=1?"onTransitionEnd":"onAnimationEnd"]:c&&u<1?null:()=>{m&&a()}})}const k=e=>{const{isRunning:n,preventExitTransition:o,toastRef:a,eventHandlers:r}=S(e),{closeButton:s,children:i,autoClose:l,onClick:c,type:u,hideProgressBar:d,closeToast:m,transition:f,position:h,className:y,style:E,bodyClassName:v,bodyStyle:T,progressClassName:b,progressStyle:w,updateId:D,role:_,progress:C,rtl:k,toastId:O,deleteToast:A,isIn:L,isLoading:P,iconOut:M,closeOnClick:R,theme:N}=e,$=p("Toastify__toast",`Toastify__toast-theme--${N}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":k},{"Toastify__toast--close-on-click":R}),F=g(y)?y({rtl:k,position:h,type:u,defaultClassName:$}):p($,y),B=!!C||!l,j={closeToast:m,type:u,theme:N};let z=null;return!1===s||(z=g(s)?s(j):(0,t.isValidElement)(s)?(0,t.cloneElement)(s,j):I(j)),t.createElement(f,{isIn:L,done:A,position:h,preventExitTransition:o,nodeRef:a},t.createElement("div",{id:O,onClick:c,className:F,...r,style:E,ref:a},t.createElement("div",{...L&&{role:_},className:g(v)?v({type:u}):p("Toastify__toast-body",v),style:T},null!=M&&t.createElement("div",{className:p("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!P})},M),t.createElement("div",null,i)),z,t.createElement(x,{...D&&!B?{key:`pb-${D}`}:{},rtl:k,theme:N,delay:l,isRunning:n,isIn:L,closeToast:m,hide:d,type:u,style:w,className:b,controlledProgress:B,progress:C||0})))},O=function(e,t){return void 0===t&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}},A=E(O("bounce",!0)),L=(E(O("slide",!0)),E(O("zoom")),E(O("flip")),(0,t.forwardRef)(((e,n)=>{const{getToastToRender:o,containerRef:a,isToastActive:r}=D(e),{className:s,style:i,rtl:l,containerId:c}=e;function u(e){const t=p("Toastify__toast-container",`Toastify__toast-container--${e}`,{"Toastify__toast-container--rtl":l});return g(s)?s({position:e,rtl:l,defaultClassName:t}):p(t,h(s))}return(0,t.useEffect)((()=>{n&&(n.current=a.current)}),[]),t.createElement("div",{ref:a,className:"Toastify",id:c},o(((e,n)=>{const o=n.length?{...i}:{...i,pointerEvents:"none"};return t.createElement("div",{className:u(e),style:o,key:`container-${e}`},n.map(((e,o)=>{let{content:a,props:s}=e;return t.createElement(k,{...s,isIn:r(s.toastId),style:{...s.style,"--nth":o+1,"--len":n.length},key:`toast-${s.key}`},a)})))})))})));L.displayName="ToastContainer",L.defaultProps={position:"top-right",transition:A,autoClose:5e3,closeButton:I,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let P,M=new Map,R=[],N=1;function $(){return""+N++}function F(e){return e&&(f(e.toastId)||m(e.toastId))?e.toastId:$()}function B(e,t){return M.size>0?T.emit(0,e,t):R.push({content:e,options:t}),t.toastId}function j(e,t){return{...t,type:t&&t.type||e,toastId:F(t)}}function z(e){return(t,n)=>B(t,j(e,n))}function H(e,t){return B(e,j("default",t))}function W(e,t){const[n,o,a]=e.split("-");console.log([n,o,a]);const r=`${n}-${o}-${a}T${t}`;return console.log("dateTimeString",r),console.log("new date",new Date(r)),new Date(r)}H.loading=(e,t)=>B(e,j("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),H.promise=function(e,t,n){let o,{pending:a,error:r,success:s}=t;a&&(o=f(a)?H.loading(a,n):H.loading(a.render,{...n,...a}));const i={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(e,t,a)=>{if(null==t)return void H.dismiss(o);const r={type:e,...i,...n,data:a},s=f(t)?{render:t}:t;return o?H.update(o,{...r,...s}):H(s.render,{...r,...s}),a},c=g(e)?e():e;return c.then((e=>l("success",s,e))).catch((e=>l("error",r,e))),c},H.success=z("success"),H.info=z("info"),H.error=z("error"),H.warning=z("warning"),H.warn=H.warning,H.dark=(e,t)=>B(e,j("default",{theme:"dark",...t})),H.dismiss=e=>{M.size>0?T.emit(1,e):R=R.filter((t=>null!=e&&t.options.toastId!==e))},H.clearWaitingQueue=function(e){return void 0===e&&(e={}),T.emit(5,e)},H.isActive=e=>{let t=!1;return M.forEach((n=>{n.isToastActive&&n.isToastActive(e)&&(t=!0)})),t},H.update=function(e,t){void 0===t&&(t={}),setTimeout((()=>{const n=function(e,t){let{containerId:n}=t;const o=M.get(n||P);return o&&o.getToast(e)}(e,t);if(n){const{props:o,content:a}=n,r={delay:100,...o,...t,toastId:t.toastId||e,updateId:$()};r.toastId!==e&&(r.staleId=e);const s=r.render||a;delete r.render,B(s,r)}}),0)},H.done=e=>{H.update(e,{progress:1})},H.onChange=e=>(T.on(4,e),()=>{T.off(4,e)}),H.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},H.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},T.on(2,(e=>{P=e.containerId||e,M.set(P,e),R.forEach((e=>{T.emit(0,e.content,e.options)})),R=[]})).on(3,(e=>{M.delete(e.containerId||e),0===M.size&&T.off(0).off(1).off(5)}));var q=({options:e,practician:n,prestation:o,selectedPractitionerId:a,selectedWeek:r,participants:s})=>{const[i,l]=(0,t.useState)(["e","r"]),[d,p]=(0,t.useState)([]),[m,f]=(0,t.useState)(!1),[g,h]=(0,t.useState)(null),[y,E]=(0,t.useState)("AM"),[v,T]=(0,t.useState)(!1),b=(0,t.useRef)(!1);(0,t.useEffect)((()=>(b.current=!0,()=>{b.current=!1})),[]),(0,t.useEffect)((()=>{m&&(console.log("dateTimeSlot",g),console.log("create date ",W(g.date,g.time)),(async(e,t,n,o,a,r)=>{console.log("rdv date: ",o);const i={practician_id:e,prestation_id:t,prestation_duration:n,rdv_dateTime:o,rdv_status:1,customer_id:null,participants:parseInt(s)};try{const e=await fetch("/wp-json/booker67/v1/add-rdv/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),t=await e.json();console.log("Succès:",t),H("Demande de rendez-vous envoyée. Un mail de confirmation vous sera envoyé.",{className:"custom-toast",position:H.POSITION.TOP_CENTER,autoClose:5e3}),console.log("first succès"),D().then(w()).then(console.log(" second succès"))}catch(e){console.error("Erreur:",e)}})(n.id,o.id,o.prestation_duration,W(g.date,g.time)))}),[m]);const w=async()=>{if(console.log("fetch appoitments"),a&&0!==a||!e.multiplePracticians&&1===a){let t=0;t=e.multiplePracticians?a:1,console.log("pract_id",t);try{const e=await fetch(`/wp-json/booker67/v1/appointments/${t}`),n=await e.json();console.log("setbooked: ",n);let o=n.map((e=>{const t=new Date(e.rdv_dateTime+"Z");return{...e,rdv_dateTime:t.toLocaleString("fr-FR",{timeZone:"Europe/Paris"})}}));console.log("setbooked after convertion: ",o),b.current&&p(o)}catch(e){console.error("Erreur lors de la récupération des rendez-vous:",e)}}},D=async()=>{if(console.log("fetch availability"),a&&0!==a){console.log("selectedPractitionerId",a);try{const e=await fetch(`/wp-json/booker67/v1/availability/${a}`),t=await e.json(),n=new Date(r.startDate),o=new Date(r.endDate),s=C(n),i=_(t,d,s),c=S(i,n,o,s);b.current&&l(c)}catch(e){console.error("Erreur lors de la récupération des disponibilités:",e)}}};(0,t.useEffect)((()=>{console.log("useeffect fetch appoitments"),w()}),[a,e.multipleAppointments]),(0,t.useEffect)((()=>{console.log("useeffect fetch availability"),D()}),[a,d,r,e.multipleAppointments]);const _=(t,n,o)=>{console.log("calculate free slots");let a=[],r=new Map,s=new Map;return console.log("options : ",e),e.multipleAppointments?(console.log("multiappointment mode"),console.log("appointments",n),console.log("availlability",t),n.forEach((e=>{const[t,n]=e.rdv_dateTime.split(" "),[o,a,r]=t.split("/"),[i,l,c]=n.split(":");new Date(r,a-1,o,i,l,c);let u=`${o.padStart(2,"0")}/${a.padStart(2,"0")}/${r} ${i.padStart(2,"0")}:${l.padStart(2,"0")}`,d=s.get(u)||0;s.set(u,d+1)})),t.forEach((t=>{let n=t.day_name.charAt(0).toUpperCase()+t.day_name.slice(1),r=o.get(n);if(r){let o=new Date(r);o.setHours(t.opening_time.split(":")[0],t.opening_time.split(":")[1],0);let i=new Date(r);i.setHours(t.closing_time.split(":")[0],t.closing_time.split(":")[1],0);let l=[];for(;o<i;){let t=`${o.getDate().toString().padStart(2,"0")}/${(o.getMonth()+1).toString().padStart(2,"0")}/${o.getFullYear()} ${o.getHours().toString().padStart(2,"0")}:${o.getMinutes().toString().padStart(2,"0")}`,n=s.get(t)||0,a=parseInt(e.maxAppointments);(0===a||n<=a)&&l.push(new Date(o)),o.setMinutes(o.getMinutes()+parseInt(e.slotDuration))}l.length>0&&(a=a.concat(l.map((e=>({day:n,date:e.toLocaleDateString("fr-FR"),time:e.toLocaleTimeString("fr-FR")})))))}}))):(t.forEach((t=>{let n=t.day_name.charAt(0).toUpperCase()+t.day_name.slice(1),a=o.get(n);if(a){let o=new Date(a);o.setHours(t.opening_time.split(":")[0],t.opening_time.split(":")[1],0);let s=new Date(a);s.setHours(t.closing_time.split(":")[0],t.closing_time.split(":")[1],0);let i=[];for(;o<s;)i.push(new Date(o)),o.setMinutes(o.getMinutes()+parseInt(e.slotDuration));r.set(n,i),console.log("Availability Map:",r)}})),n.forEach((e=>{console.log("Processing appointment:",e);const[t,n]=e.rdv_dateTime.split(" "),[o,a,s]=t.split("/"),[i,l,c]=n.split(":");let u=new Date(s,a-1,o,i,l,c),d=parseInt(e.prestation_duration.split(":")[0]),p=parseInt(e.prestation_duration.split(":")[1]||"0"),m=new Date(u);m.setHours(m.getHours()+d),m.setMinutes(m.getMinutes()+p);let f=u.toLocaleDateString("fr-FR",{weekday:"long"});f=f.charAt(0).toUpperCase()+f.slice(1);let g=r.get(f);console.log("appointmentEnd: ",m),console.log("appointmentStart: ",u),console.log("daylsot",g),g&&r.set(f,g.filter((e=>e<u||e>=m))),console.log("Availability Map after processing appointment:",r)})),console.log("Final Availability Map before conversion:",r),r.forEach(((e,t)=>{e.forEach((e=>{let n=e.toLocaleDateString("fr-FR");a.push({day:t,date:n,time:e.toLocaleTimeString("fr-FR")})}))}))),console.log(a),a},C=e=>{let t=new Map;for(;1!==e.getDay();)e.setDate(e.getDate()-1);for(let n=0;n<7;n++){let o=new Date(e);o.setDate(e.getDate()+n);let a=o.toLocaleDateString("fr-FR",{weekday:"long"});a=a.charAt(0).toUpperCase()+a.slice(1),t.set(a,o)}return t},S=(e,t,n,o)=>e.filter((e=>{const a=o.get(e.day);return a&&a>=t&&a<=n})),I=new Date(r.startDate),x=new Date(r.endDate),k=C(I),O=S(i,I,x,k).reduce(((e,t)=>(e[t.day]=e[t.day]||[],e[t.day].push({...t,isAvailable:!0}),e)),{});return(0,t.createElement)("div",null,i.length>0?(0,t.createElement)("div",null,(0,t.createElement)(u,{onSelectionChange:e=>{E(e)}}),(0,t.createElement)(c,{slotsByDay:O,practician:n,prestation:o,selectedWeek:r,setNewAppointment:f,daysOfWeek:["Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],dateTimeSlot:g,setDateTimeSlot:h,timeOfDay:y})):(0,t.createElement)("p",null,"Aucun créneau disponible pour cette semaine."))},U=({onWeekChange:e})=>{const n=(new Date).toISOString().split("T")[0],[o,a]=(0,t.useState)(n);return(0,t.createElement)("input",{type:"date",value:o,onChange:t=>{a(t.target.value);let n=(e=>{const t=new Date(e);t.setDate(t.getDate()-t.getDay()+1);const n=new Date(t);return n.setDate(n.getDate()+6),{startDate:t,endDate:n}})(new Date(t.target.value));e(n),console.log(n)},min:n})},V=function({onNumberChange:e}){const[n,o]=(0,t.useState)(1);return(0,t.createElement)("div",null,(0,t.createElement)("label",{htmlFor:"number-of-participants"},"Nombre de participants :"),(0,t.createElement)("select",{id:"number-of-participants",value:n,onChange:t=>{e(t.target.value)}},Array.from({length:50},((e,n)=>(0,t.createElement)("option",{key:n+1,value:n+1},n+1)))))};const Q=()=>{const[e,n]=(0,t.useState)({hasFixedTimeSlots:!1,slotDuration:30,multipleAppointments:!1,maxAppointments:0,multiplePracticians:!0,multiPrestations:!0,indicateNumberOfParticipants:!1,allowObservations:!1,participants:1}),[o,a]=(0,t.useState)(0),[i,l]=(0,t.useState)(0),[c,u]=(0,t.useState)(null),[d,p]=(0,t.useState)(null),[m,f]=(0,t.useState)(1);(0,t.useEffect)((()=>{(async function(e){try{let t=new URL("https://wordpress-react-test.local/wp-json/booker67/v1/options/filter");e.forEach((e=>t.searchParams.append("types[]",e)));const n=await fetch(t);if(!n.ok)throw new Error("Erreur réseau ou serveur");const o=await n.json();return console.log("Options récupérées:",o),o}catch(e){console.error("Erreur lors de la récupération des options:",e)}})(["genType_hasFixedTimeSlots","genType_multipleAppointments","genType_slotDuration","genType_maxAppointments","genType_multiplePracticians","genType_multiPrestations","genType_indicateNumberOfParticipants","genType_allowObservations"]).then((e=>{n(g(e))})),e.multiplePracticians,E(1),e.multiPrestations||v(1)}),[o]);const g=t=>{let n={...e};return t.forEach((e=>{const t=e.generic_type.replace("genType_","");n[t]="true"===e.value||"false"===e.value?"true"===e.value:e.value})),n},[h,y]=(0,t.useState)({startDate:(()=>{const e=new Date,t=new Date(e);return t.setDate(t.getDate()-t.getDay()+1),t.toISOString().split("T")[0]})(),endDate:(()=>{const e=new Date,t=new Date(e);return t.setDate(t.getDate()-t.getDay()+7),t.toISOString().split("T")[0]})()}),E=async e=>{const t=`/wp-json/booker67/v1/human-ressource/${e}`;try{const n=await fetch(t);if(!n.ok)throw new Error("Erreur réseau lors de la récupération des données");const r=await n.json();u(r),o!==e&&a(e)}catch(e){console.error("Erreur lors de la récupération des données:",e)}},v=async e=>{console.log("handleprestation change"),l(e);const t=`/wp-json/booker67/v1/prestation/${e}`;try{const e=await fetch(t);if(!e.ok)throw new Error("Erreur réseau lors de la récupération de la prestation");const n=await e.json();p(n)}catch(e){console.error("Erreur lors de la récupération de la prestation:",e)}};return(0,t.createElement)("div",null,(0,t.createElement)(L,null),e.multiplePracticians&&(0,t.createElement)(s,{onPractitionerChange:E}),e.multiPrestations&&(0,t.createElement)(r,{practitionerId:o,onPrestationChange:v}),(0,t.createElement)(U,{onWeekChange:e=>{y(e)}}),e.indicateNumberOfParticipants&&(0,t.createElement)(V,{onNumberChange:e=>{f(e)}}),o&&(0,t.createElement)(q,{options:e,practician:c,prestation:d,selectedPractitionerId:o,selectedWeek:h,participants:m}))};document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("booking67-root");e&&o().render((0,t.createElement)(Q,null),e)}))}();