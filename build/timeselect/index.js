!function(){"use strict";var e,t={921:function(){var e=window.wp.blocks,t=window.React,r=(window.wp.i18n,window.wp.blockEditor,window.wp.components),n=(window.wp.apiFetch,window.wp.element),o=JSON.parse('{"u2":"booker67/timeselect"}');(0,e.registerBlockType)(o.u2,{attributes:{days:{type:"object",default:{Monday:!1,Tuesday:!1,Wednesday:!1,Thursday:!1,Friday:!1,Saturday:!1,Sunday:!1}}},edit:function({apiRoot:e,apiNonce:o}){const[a,s]=(0,n.useState)((new Date).toISOString().split("T")[0]),[i,c]=(0,n.useState)([]),[l,u]=(0,n.useState)([]),[d,h]=(0,n.useState)(null),f=(()=>{let e=[];for(let t=8;t<=20;t++)for(let r=0;r<2;r++){let n=0===r?"00":"30",o=0===r?"30":"00",a=0===r?t:t+1;e.push(`${t}:${n}-${a}:${o}`)}return e})();return(0,n.useEffect)((()=>{a&&fetch(`${e}booker67/v1/get-times?date=${a}`,{method:"GET",headers:{"X-WP-Nonce":o}}).then((e=>e.json())).then((e=>{u(e)})).catch((()=>{console.error("Erreur lors de la récupération des créneaux horaires.")}))}),[a,e,o]),(0,t.createElement)("div",null,(0,t.createElement)(r.DatePicker,{currentDate:a,onChange:e=>s(e)}),(0,t.createElement)("div",null,f.map(((e,r)=>(0,t.createElement)("button",{key:r,style:{backgroundColor:i.includes(e)?"green":"white"},onClick:()=>(e=>{i.includes(e)?c((t=>t.filter((t=>t!==e)))):c((t=>[...t,e]))})(e)},e)))),(0,t.createElement)("div",{className:"available-time-slots"},l.map(((e,r)=>(0,t.createElement)("button",{key:r,className:"time-slot "+(d===e?"selected":""),onClick:()=>h(e)},`${e.start} - ${e.end}`)))),(0,t.createElement)("button",{onClick:()=>{fetch(`${e}booker67/v1/save-times`,{method:"POST",headers:{"X-WP-Nonce":o,"Content-Type":"application/json"},body:JSON.stringify({date:a,slots:i})}).then((e=>e.json())).then((e=>{e.success?alert("Créneaux horaires enregistrés avec succès."):alert("Erreur lors de l'enregistrement des créneaux horaires.")})).catch((e=>{console.error("Erreur lors de la réservation du créneau horaire.",e)}))}},"Enregistrer"),(0,t.createElement)("button",{onClick:()=>{d?fetch(`${e}booker67/v1/book-time`,{method:"POST",headers:{"X-WP-Nonce":o,"Content-Type":"application/json"},body:JSON.stringify({start_time:d.start,end_time:d.end,date:a})}).then((()=>{alert("Créneau horaire réservé avec succès!")})).catch((()=>{console.error("Erreur lors de la réservation du créneau horaire.")})):alert("Veuillez d'abord choisir un créneau horaire.")}},"Réserver"))},save:function(){return(0,t.createElement)("div",{className:"time-select-block"},(0,t.createElement)("div",{className:"available-time-slots"}," toto"))}})}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,n),a.exports}n.m=t,e=[],n.O=function(t,r,o,a){if(!r){var s=1/0;for(u=0;u<e.length;u++){r=e[u][0],o=e[u][1],a=e[u][2];for(var i=!0,c=0;c<r.length;c++)(!1&a||s>=a)&&Object.keys(n.O).every((function(e){return n.O[e](r[c])}))?r.splice(c--,1):(i=!1,a<s&&(s=a));if(i){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,o,a]},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={828:0,475:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,a,s=r[0],i=r[1],c=r[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(c)var u=c(n)}for(t&&t(r);l<s.length;l++)a=s[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},r=self.webpackChunkbooker67=self.webpackChunkbooker67||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var o=n.O(void 0,[475],(function(){return n(921)}));o=n.O(o)}();